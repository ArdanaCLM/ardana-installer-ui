{"name":"entry-scale-kvm-vsa","version":2,"readme":{"html":"<dl class=\"dl-horizontal\">\n  <dt>Compute Hypervisor</dt><dd>KVM</dd>\n  <dt>Block Storage</dt><dd>VSA (optional)</dd>\n  <dt>Object Storage</dt><dd>minimal Swift on Control Plane servers</dd>\n</dl>\n<p><b>Node roles</b></p>\n<ul>\n  <li>Control Plane, includes Deployer node (3 nodes)</li>\n  <li>VSA (0 or 3, nodes)</li>\n  <li>Compute (minimum 1 node)</li>\n</ul>\n\n<p>This example separates network traffic into four logical networks which are carried on a pair of bonded physical ports.</p>\n\n<p><b>Logical network separation:</b></p>\n<ol>\n<li>External API - used by consumers of the cloud to make requests to the cloud APIs</li>\n<li>External VM - used to provide external access to VMs (via floating IP addresses)</li>\n<li>Guest - carries traffic between VMs on private networks within the cloud (VxLAN encapsulated)</li>\n<li>Management - used for all internal traffic between the cloud services. This network is also used to provision and configure the cloud servers.</li>\n</ol>\n<p>\nIn addition, each server is connected to a dedicated IPMI/iLO network. This is used for power management during installation.\n</p>","md":"##Ardana Entry Scale Cloud with VSA Example##\n\nThe input files in this example deploy a cloud that has the following characteristics:\n\n\n### Control Planes ###\n\n- A single control plane consisting of three servers that co-host all of the required services.\n\n###Resource Pools###\n\n- One compute Node\n\n- One VSA Node\n\n*Additional resource nodes can be added to the configuration.*\n\n*Minimal Swift Resources are provided by the control plane*\n\n###Deployer Node###\n\n\nThis configuration runs the lifecycle-manager (formerly referred to as the deployer) on a control plane node.\nYou need to include this node address in your servers.yml definition. This function does not need a dedicated network.\n\n*The minimum server count for this example is therefore 4 servers (Control Plane (x3) + Compute (x1) + VSA) (x0)*\nThe the minimum configuration will have no cinder volume capability. To provide this you must have at least one VSA node,\ngiving a total node count of 5 servers.\n\nAn example set of servers are defined in ***data/servers.yml***.   You will need to modify this file to reflect your specific environment.\n\n\n###Networking###\n\nThe example requires the following networks:\n\nIPMI/iLO network, connected to the deployer and the IPMI/iLO ports of all servers\n\nA pair of bonded NICs which are used by the following networks:\n\n- External API - This is the network that users will use to make requests to the cloud\n- External VM - This is the network that will be used to provide access to VMs (via floating IP addresses)\n- Guest - This is the network that will carry traffic between VMs on private networks within the cloud\n- Cloud Management - This is the network that will be used for all internal traffic between the cloud services, This network is also\nused to install and configure the nodes. This network needs to be on an untagged VLAN\n\nNote that the EXTERNAL\\_API network must be reachable from the EXTERNAL\\_VM network if you want VMs to be able to make API calls to the cloud.\n\nAn example set of networks are defined in ***data/networks.yml***.    You will need to modify this file to reflect your environment.\n\nThe example uses the devices hed3 & hed4 as a bonded network for all services.   If you need to modify these\nfor your environment they are defined in ***data/net_interfaces.yml*** The network devices eth3 & eth4 are renamed to devices hed4 & hed5 using the PCI bus mappings secified in  ***data/nic_mappings.yml***. You may need to modify the PCI bus addresses to match your system.\n\n###Local Storage###\n\nAll servers should present a single OS disk, protected by a RAID controller. This disk needs to be at least 512GB in capacity.   In addition the example configures one additional disk depending on the role of the server:\n\n- Controllers:  /dev/sdb is configured to be used by Swift\n- Compute Severs:  /dev/sdb is configured as an additional Volume Group to be used for VM storage\n- VSA Servers:  /dev/sdb is configured for VSA storage\n\nAdditional discs can be configured for any of these roles by editing the corresponding ***data/disks_*.yml*** file\n\n"},"fileInfo":{"configFile":"C:\\Users\\nwm\\ardana\\examples\\entry-scale-kvm-vsa\\cloudConfig.yml","directory":"C:\\Users\\nwm\\ardana\\examples\\entry-scale-kvm-vsa","files":["cloudConfig.yml","data\\control_plane.yml","data\\disks_compute.yml","data\\disks_controller.yml","data\\disks_controller_1TB.yml","data\\disks_vsa.yml","data\\network_groups.yml","data\\networks.yml","data\\nic_mappings.yml","data\\net_interfaces.yml","data\\servers.yml","data\\server_groups.yml","data\\firewall_rules.yml","data\\server_roles.yml","data\\swift\\rings.yml"],"sections":{"product":["cloudConfig.yml","data\\control_plane.yml","data\\disks_compute.yml","data\\disks_controller_1TB.yml","data\\disks_vsa.yml","data\\network_groups.yml","data\\networks.yml","data\\disks_controller.yml","data\\net_interfaces.yml","data\\nic_mappings.yml","data\\servers.yml","data\\server_groups.yml","data\\firewall_rules.yml","data\\server_roles.yml","data\\swift\\rings.yml"],"cloud":["cloudConfig.yml"],"control-planes":["data\\control_plane.yml"],"disk-models":["data\\disks_compute.yml","data\\disks_controller_1TB.yml","data\\disks_vsa.yml","data\\disks_controller.yml"],"network-groups":["data\\network_groups.yml"],"networks":["data\\networks.yml"],"interface-models":["data\\net_interfaces.yml"],"nic-mappings":["data\\nic_mappings.yml"],"baremetal":["data\\servers.yml"],"servers":["data\\servers.yml"],"server-groups":["data\\server_groups.yml"],"firewall-rules":["data\\firewall_rules.yml"],"server-roles":["data\\server_roles.yml"],"ring-specifications":["data\\swift\\rings.yml"]},"fileSectionMap":{"cloudConfig.yml":["product","cloud"],"data\\control_plane.yml":["product",{"control-planes":["control-plane-1"],"keyField":"name"}],"data\\disks_compute.yml":["product",{"disk-models":["COMPUTE-DISKS"],"keyField":"name"}],"data\\disks_controller_1TB.yml":["product",{"disk-models":["CONTROLLER-1TB-DISKS"],"keyField":"name"}],"data\\disks_vsa.yml":["product",{"disk-models":["VSA-DISKS"],"keyField":"name"}],"data\\network_groups.yml":["product",{"network-groups":["EXTERNAL-API","EXTERNAL-VM","GUEST","MANAGEMENT"],"keyField":"name"}],"data\\networks.yml":["product",{"networks":["EXTERNAL-API-NET","EXTERNAL-VM-NET","GUEST-NET","MANAGEMENT-NET"],"keyField":"name"}],"data\\disks_controller.yml":["product",{"disk-models":["CONTROLLER-DISKS"],"keyField":"name"}],"data\\net_interfaces.yml":["product",{"interface-models":["CONTROLLER-INTERFACES","COMPUTE-INTERFACES","VSA-INTERFACES"],"keyField":"name"}],"data\\nic_mappings.yml":["product",{"nic-mappings":["HP-DL360-4PORT","MY-2PORT-SERVER"],"keyField":"name"}],"data\\servers.yml":["product","baremetal",{"servers":["controller1","controller2","controller3","compute1","vsa1","vsa2","vsa3"],"keyField":"id"}],"data\\server_groups.yml":["product",{"server-groups":["CLOUD","AZ1","AZ2","AZ3","RACK1","RACK2","RACK3"],"keyField":"name"}],"data\\firewall_rules.yml":["product",{"firewall-rules":["PING"],"keyField":"name"}],"data\\server_roles.yml":["product",{"server-roles":["CONTROLLER-ROLE","COMPUTE-ROLE","VSA-ROLE"],"keyField":"name"}],"data\\swift\\rings.yml":["product",{"ring-specifications":["region1"],"keyField":"region-name"}]},"mtime":1449509082101},"errors":[],"inputModel":{"cloud":{"name":"entry-scale-kvm-vsa","hostname-data":{"host-prefix":"ardana","member-prefix":"-m"},"ntp-servers":null,"dns-settings":null,"smtp-settings":null,"firewall-settings":{"enable":true,"logging":true}},"product":{"version":2},"control-planes":[{"name":"control-plane-1","control-plane-prefix":"cp1","region-name":"region1","failure-zones":["AZ1","AZ2","AZ3"],"common-service-components":["logging-producer","monasca-agent","freezer-agent","stunnel","lifecycle-manager-target"],"clusters":[{"name":"cluster1","cluster-prefix":"c1","server-role":"CONTROLLER-ROLE","member-count":3,"allocation-policy":"strict","service-components":["lifecycle-manager","ntp-server","swift-ring-builder","mysql","ip-cluster","apache2","keystone-api","keystone-client","rabbitmq","glance-api","glance-registry","glance-client","cinder-api","cinder-scheduler","cinder-volume","cinder-backup","cinder-client","nova-api","nova-scheduler","nova-conductor","nova-console-auth","nova-novncproxy","nova-client","neutron-server","neutron-ml2-plugin","neutron-vpn-agent","neutron-dhcp-agent","neutron-metadata-agent","neutron-openvswitch-agent","neutron-client","horizon","sherpa-api","swift-proxy","memcached","swift-account","swift-container","swift-object","swift-client","heat-api","heat-api-cfn","heat-api-cloudwatch","heat-engine","heat-client","openstack-client","ceilometer-api","ceilometer-collector","ceilometer-agent-central","ceilometer-agent-notification","ceilometer-expirer","ceilometer-common","ceilometer-client","zookeeper","kafka","vertica","storm","monasca-api","monasca-persister","monasca-notifier","monasca-threshold","monasca-client","logging-server","ops-console-web","ops-console-monitor","cmc-service","freezer-api"]}],"resources":[{"name":"compute","resource-prefix":"comp","server-role":"COMPUTE-ROLE","allocation-policy":"any","min-count":0,"service-components":["ntp-client","nova-compute","nova-compute-kvm","neutron-l3-agent","neutron-metadata-agent","neutron-openvswitch-agent","neutron-lbaasv2-agent"]},{"name":"vsa","resource-prefix":"vsa","server-role":"VSA-ROLE","allocation-policy":"strict","min-count":0,"service-components":["ntp-client","vsa"]}]}],"disk-models":[{"name":"COMPUTE-DISKS","volume-groups":[{"name":"ardana-vg","physical-volumes":["/dev/sda_root"],"logical-volumes":[{"name":"root","size":"35%","fstype":"ext4","mount":"/"},{"name":"log","size":"50%","mount":"/var/log","fstype":"ext4","mkfs-opts":"-O large_file"},{"name":"crash","size":"10%","mount":"/var/crash","fstype":"ext4","mkfs-opts":"-O large_file"}]},{"name":"vg-comp","physical-volumes":["/dev/sdb"],"logical-volumes":[{"name":"compute","size":"95%","mount":"/var/lib/nova","fstype":"ext4","mkfs-opts":"-O large_file"}]}]},{"name":"CONTROLLER-DISKS","volume-groups":[{"name":"ardana-vg","physical-volumes":["/dev/sda_root"],"logical-volumes":[{"name":"root","size":"10%","fstype":"ext4","mount":"/"},{"name":"crash","size":"13%","mount":"/var/crash","fstype":"ext4","mkfs-opts":"-O large_file"},{"name":"log","size":"13%","mount":"/var/log","fstype":"ext4","mkfs-opts":"-O large_file"},{"name":"mysql","size":"10%","mount":"/var/lib/mysql","fstype":"ext4","mkfs-opts":"-O large_file","consumer":{"name":"mysql"}},{"name":"rabbitmq","size":"13%","mount":"/var/lib/rabbitmq","fstype":"ext4","mkfs-opts":"-O large_file","consumer":{"name":"rabbitmq","rabbitmq_env":"home"}},{"name":"vertica","size":"3%","mount":"/var/vertica","fstype":"ext4","mkfs-opts":"-O large_file","consumer":{"name":"vertica"}},{"name":"kafka","size":"2%","mount":"/var/kafka","fstype":"ext4","mkfs-opts":"-O large_file","consumer":{"name":"kafka"}},{"name":"elasticsearch","size":"30%","mount":"/var/lib/elasticsearch","fstype":"ext4"},{"name":"zookeeper","size":"1%","mount":"/var/lib/zookeeper","fstype":"ext4"}],"consumer":{"name":"os"}}],"device-groups":[{"name":"swiftobj","devices":[{"name":"/dev/sdb"},{"name":"/dev/sdc"}],"consumer":{"name":"swift","attrs":{"rings":["account","container","object-0"]}}}]},{"name":"CONTROLLER-1TB-DISKS","volume-groups":[{"name":"ardana-vg","physical-volumes":["/dev/sda_root"],"logical-volumes":[{"name":"root","size":"5%","fstype":"ext4","mount":"/"},{"name":"crash","size":"8%","mount":"/var/crash","fstype":"ext4","mkfs-opts":"-O large_file"},{"name":"log","size":"10%","mount":"/var/log","fstype":"ext4","mkfs-opts":"-O large_file"},{"name":"mysql","size":"10%","mount":"/var/lib/mysql","fstype":"ext4","mkfs-opts":"-O large_file","consumer":{"name":"mysql"}},{"name":"rabbitmq","size":"8%","mount":"/var/lib/rabbitmq","fstype":"ext4","mkfs-opts":"-O large_file","consumer":{"name":"rabbitmq","rabbitmq_env":"home"}},{"name":"vertica","size":"5%","mount":"/var/vertica","fstype":"ext4","mkfs-opts":"-O large_file","consumer":{"name":"vertica"}},{"name":"kafka","size":"2%","mount":"/var/kafka","fstype":"ext4","mkfs-opts":"-O large_file","consumer":{"name":"kafka"}},{"name":"elasticsearch","size":"45%","mount":"/var/lib/elasticsearch","fstype":"ext4"},{"name":"zookeeper","size":"1%","mount":"/var/lib/zookeeper","fstype":"ext4"}],"consumer":{"name":"os"}}],"device-groups":[{"name":"swiftobj","devices":[{"name":"/dev/sdb"},{"name":"/dev/sdc"}],"consumer":{"name":"swift","attrs":{"rings":["account","container","object-0"]}}}]},{"name":"VSA-DISKS","volume-groups":[{"name":"ardana-vg","physical-volumes":["/dev/sda_root"],"logical-volumes":[{"name":"root","size":"30%","fstype":"ext4","mount":"/"},{"name":"log","size":"45%","mount":"/var/log","fstype":"ext4","mkfs-opts":"-O large_file"},{"name":"crash","size":"20%","mount":"/var/crash","fstype":"ext4","mkfs-opts":"-O large_file"}],"consumer":{"name":"os"}}],"device-groups":[{"name":"vsa-data","consumer":{"name":"vsa","usage":"data"},"devices":[{"name":"/dev/sdc"}]},{"name":"vsa-cache","consumer":{"name":"vsa","usage":"adaptive-optimization"},"devices":[{"name":"/dev/sdb"}]}]}],"network-groups":[{"name":"EXTERNAL-API","hostname-suffix":"extapi","load-balancers":[{"provider":"ip-cluster","name":"extlb","external-name":null,"tls-components":["default"],"roles":["public"],"cert-file":"my-public-cert"}]},{"name":"EXTERNAL-VM","tags":["neutron.l3_agent.external_network_bridge"]},{"name":"GUEST","hostname-suffix":"guest","tags":["neutron.networks.vxlan"]},{"name":"MANAGEMENT","hostname-suffix":"mgmt","hostname":true,"component-endpoints":["default"],"routes":["default"],"load-balancers":[{"provider":"ip-cluster","name":"lb","components":["default"],"roles":["internal","admin"]}],"tags":[{"neutron.networks.vlan":{"provider-physical-network":"physnet1"}}]}],"networks":[{"name":"EXTERNAL-API-NET","vlanid":101,"tagged-vlan":true,"cidr":"10.0.1.0/24","gateway-ip":"10.0.1.1","network-group":"EXTERNAL-API"},{"name":"EXTERNAL-VM-NET","vlanid":102,"tagged-vlan":true,"network-group":"EXTERNAL-VM"},{"name":"GUEST-NET","vlanid":103,"tagged-vlan":true,"cidr":"10.1.1.0/24","gateway-ip":"10.1.1.1","network-group":"GUEST"},{"name":"MANAGEMENT-NET","vlanid":100,"tagged-vlan":false,"cidr":"192.168.10.0/24","gateway-ip":"192.168.10.1","network-group":"MANAGEMENT"}],"nic-mappings":[{"name":"HP-DL360-4PORT","physical-ports":[{"logical-name":"hed1","type":"simple-port","bus-address":"0000:07:00.0"},{"logical-name":"hed2","type":"simple-port","bus-address":"0000:08:00.0"},{"logical-name":"hed3","type":"simple-port","bus-address":"0000:09:00.0"},{"logical-name":"hed4","type":"simple-port","bus-address":"0000:0a:00.0"}]},{"name":"MY-2PORT-SERVER","physical-ports":[{"logical-name":"hed3","type":"simple-port","bus-address":"0000:04:00.0"},{"logical-name":"hed4","type":"simple-port","bus-address":"0000:04:00.1"}]}],"interface-models":[{"name":"CONTROLLER-INTERFACES","network-interfaces":[{"name":"BOND0","device":{"name":"bond0"},"bond-data":{"options":{"mode":"active-backup","miimon":200,"primary":"hed3"},"provider":"linux","devices":[{"name":"hed3"},{"name":"hed4"}]},"network-groups":["EXTERNAL-API","EXTERNAL-VM","GUEST","MANAGEMENT"]}]},{"name":"COMPUTE-INTERFACES","network-interfaces":[{"name":"BOND0","device":{"name":"bond0"},"bond-data":{"options":{"mode":"active-backup","miimon":200,"primary":"hed3"},"provider":"linux","devices":[{"name":"hed3"},{"name":"hed4"}]},"network-groups":["EXTERNAL-VM","GUEST","MANAGEMENT"]}]},{"name":"VSA-INTERFACES","network-interfaces":[{"name":"BOND0","device":{"name":"bond0"},"bond-data":{"options":{"mode":"active-backup","miimon":200,"primary":"hed3"},"provider":"linux","devices":[{"name":"hed3"},{"name":"hed4"}]},"network-groups":["MANAGEMENT"]}]}],"baremetal":{"subnet":"192.168.10.0","netmask":"255.255.255.0"},"servers":[{"id":"controller1","ip-addr":"192.168.10.3","role":"CONTROLLER-ROLE","server-group":"RACK1","nic-mapping":"HP-DL360-4PORT","mac-addr":"b2:72:8d:ac:7c:6f","ilo-ip":"192.168.9.3","ilo-password":"password","ilo-user":"admin"},{"id":"controller2","ip-addr":"192.168.10.4","role":"CONTROLLER-ROLE","server-group":"RACK2","nic-mapping":"HP-DL360-4PORT","mac-addr":"8a:8e:64:55:43:76","ilo-ip":"192.168.9.4","ilo-password":"password","ilo-user":"admin"},{"id":"controller3","ip-addr":"192.168.10.5","role":"CONTROLLER-ROLE","server-group":"RACK3","nic-mapping":"HP-DL360-4PORT","mac-addr":"26:67:3e:49:5a:a7","ilo-ip":"192.168.9.5","ilo-password":"password","ilo-user":"admin"},{"id":"compute1","ip-addr":"192.168.10.6","role":"COMPUTE-ROLE","server-group":"RACK1","nic-mapping":"MY-2PORT-SERVER","mac-addr":"d6:70:c1:36:43:f7","ilo-ip":"192.168.9.6","ilo-password":"password","ilo-user":"admin"},{"id":"vsa1","ip-addr":"192.168.10.9","server-group":"RACK1","role":"VSA-ROLE","nic-mapping":"MY-2PORT-SERVER","mac-addr":"8b:f6:9e:ca:3b:78","ilo-ip":"192.168.9.9","ilo-password":"password","ilo-user":"admin"},{"id":"vsa2","ip-addr":"192.168.10.10","server-group":"RACK2","role":"VSA-ROLE","nic-mapping":"MY-2PORT-SERVER","mac-addr":"8b:f6:9e:ca:3b:79","ilo-ip":"192.168.9.10","ilo-password":"password","ilo-user":"admin"},{"id":"vsa3","ip-addr":"192.168.10.11","role":"VSA-ROLE","server-group":"RACK3","nic-mapping":"MY-2PORT-SERVER","mac-addr":"8b:f6:9e:ca:3b:7a","ilo-ip":"192.168.9.11","ilo-password":"password","ilo-user":"admin"}],"server-groups":[{"name":"CLOUD","server-groups":["AZ1","AZ2","AZ3"],"networks":["EXTERNAL-API-NET","EXTERNAL-VM-NET","GUEST-NET","MANAGEMENT-NET"]},{"name":"AZ1","server-groups":["RACK1"]},{"name":"AZ2","server-groups":["RACK2"]},{"name":"AZ3","server-groups":["RACK3"]},{"name":"RACK1"},{"name":"RACK2"},{"name":"RACK3"}],"firewall-rules":[{"name":"PING","network-groups":["MANAGEMENT","GUEST","EXTERNAL-API"],"rules":[{"type":"allow","remote-ip-prefix":"0.0.0.0/0","port-range-min":8,"port-range-max":0,"protocol":"icmp"}]}],"server-roles":[{"name":"CONTROLLER-ROLE","interface-model":"CONTROLLER-INTERFACES","disk-model":"CONTROLLER-DISKS"},{"name":"COMPUTE-ROLE","interface-model":"COMPUTE-INTERFACES","disk-model":"COMPUTE-DISKS"},{"name":"VSA-ROLE","interface-model":"VSA-INTERFACES","disk-model":"VSA-DISKS"}],"ring-specifications":[{"region-name":"region1","rings":[{"name":"account","display-name":"Account Ring","min-part-time":16,"partition-power":12,"replication-policy":{"replica-count":3}},{"name":"container","display-name":"Container Ring","min-part-time":16,"partition-power":12,"replication-policy":{"replica-count":3}},{"name":"object-0","display-name":"General","default":"yes","min-part-time":16,"partition-power":12,"replication-policy":{"replica-count":3}}]}]}}